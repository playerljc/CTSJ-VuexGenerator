var $store,$serviceConfig,$modules,__assign=this&&this.__assign||function(){return(__assign=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},__rest=this&&this.__rest||function(e,t){var n={};for(i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var r=0,i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]]);return n};import{mapActions as mappingActions,mapState as mappingState,mapMutations as mappingMutations}from"vuex";function createActions(e){for(var c=e.namespace,u=e.service,t=e.serviceKeys,n={},r=0;r<t.length;r++)!function(e){var s=t[e];if("default"===s)return;n[s]=function(e,n){var a=e.commit,o=e.state;return new Promise(function(i,t){a("loading/receive",{key:c+"/"+s,value:!0},{root:!0}),u[s].call(n).then(function(e){var t=u.default,n=t.codeKey,r=t.codeSuccessKey,t=t.dataKey;e[n]===r&&(a("receive",__assign(__assign({},o),((r={})[s]=e[t],r))),a("loading/receive",{key:c+"/"+s,value:!1},{root:!0}),i(e))}).catch(function(e){t(e)})})}}(r);return n}function registerLoading(){for(var n={global:!1},r=Object.keys($modules),e=0;e<r.length;e++)!function(e){var t=r[e],e=$serviceConfig[t];Object.keys(e).forEach(function(e){"default"!==e&&(n[t+"/"+e]=!1)})}(e);$store.registerModule("loading",{namespaced:!0,state:n,mutations:{receive:function(e,t){var n=t.key,t=t.value;e[n]=t;e.global;for(var r=__rest(e,["global"]),i=!1,a=Object.keys(r),o=0;o<a.length;o++)if(r[a[o]]){i=!0;break}e.global=i}}})}function registerBusinessModules(){for(var a=Object.keys($modules),e=0;e<a.length;e++)!function(e){var t=a[e],n=$modules[t],r=$serviceConfig[t],e=Object.keys(r),i={};e.forEach(function(e){"default"!==e&&(i[e]=r[e].defaultResult())}),$store.registerModule(t,{namespaced:!0,state:function(){return __assign(__assign({},i),(n||{}).state||{})},mutations:__assign({receive:function(e,t){for(var n=Object.keys(e),r=0;r<n.length;r++){var i=n[r];e[i]=t[i]}}},(n||{}).mutations||{}),getters:__assign({},(n||{}).getters||{}),actions:__assign(__assign({},createActions({namespace:t,service:r,serviceKeys:e})),(n||{}).actions||{})})}(e)}function formatKey(e){return""+e.charAt(0).toUpperCase()+e.substring(1)}var plugin=function(e,t){return $serviceConfig=e,$modules=t,function(e){$store=e,registerLoading(),registerBusinessModules()}},mapState=function(i){function e(e){for(var n=i[e],e=$serviceConfig[n],r=Object.keys(e),t=0;t<r.length;t++)!function(e){var t=r[e];if("default"===t)return;a[""+n+formatKey(t)]=function(e){return e[n][t]}}(t)}for(var a={loading:function(e){return e.loading}},t=0;t<i.length;t++)e(t);return mappingState(a)},mapActions=function(e){for(var t={},n=0;n<e.length;n++)for(var r=e[n],i=$serviceConfig[r],a=Object.keys(i),o=0;o<a.length;o++){var s=a[o];"default"!==s&&(t[""+r+formatKey(s)+"Action"]=r+"/"+s)}return mappingActions(t)},mapMutations=function(e){for(var t={},n=0;n<e.length;n++){var r=e[n];t[r+"ReceiveMutation"]=r+"/receive"}return mappingMutations(t)},cleanMixin=function(e){return{beforeDestroy:function(){var i=this;e.forEach(function(e){var t=$serviceConfig[e],n=Object.keys(t),r={};n.forEach(function(e){"default"!==e&&(r[e]=t[e].defaultResult())}),i.$store.commit(e+"/receive",r)})}}};export default plugin;export{mapState,mapActions,mapMutations,cleanMixin};
//# sourceMappingURL=vuexgenerator.js.map
