"use strict";var $store,$serviceConfig,$modules,__assign=this&&this.__assign||function(){return(__assign=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},__rest=this&&this.__rest||function(e,t){var n={};for(o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(n[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var r=0,o=Object.getOwnPropertySymbols(e);r<o.length;r++)t.indexOf(o[r])<0&&Object.prototype.propertyIsEnumerable.call(e,o[r])&&(n[o[r]]=e[o[r]]);return n},vuex_1=(Object.defineProperty(exports,"__esModule",{value:!0}),exports.cleanMixin=exports.mapMutations=exports.mapActions=exports.mapState=void 0,require("vuex"));function createActions(e){for(var c=e.namespace,u=e.service,t=e.serviceKeys,n={},r=0;r<t.length;r++)!function(e){var a=t[e];if("default"===a)return;n[a]=function(e,n){var s=e.commit,i=e.state;return new Promise(function(o,t){s("loading/receive",{key:c+"/"+a,value:!0},{root:!0}),u[a].call(n).then(function(e){var t=u.default,n=t.codeKey,r=t.codeSuccessKey,t=t.dataKey;e[n]===r&&(s("receive",__assign(__assign({},i),((n={})[a]=e[t],n))),s("loading/receive",{key:c+"/"+a,value:!1},{root:!0}),o(e))}).catch(function(e){t(e)})})}}(r);return n}function registerLoading(){for(var n={global:!1},r=Object.keys($modules),e=0;e<r.length;e++)!function(e){var t=r[e],e=$serviceConfig[t];Object.keys(e).forEach(function(e){"default"!==e&&(n[t+"/"+e]=!1)})}(e);$store.registerModule("loading",{namespaced:!0,state:n,mutations:{receive:function(e,t){for(var n=t.key,t=t.value,r=(e[n]=t,e.global,__rest(e,["global"])),o=!1,s=Object.keys(r),i=0;i<s.length;i++)if(r[s[i]]){o=!0;break}e.global=o}}})}function registerBusinessModules(){for(var s=Object.keys($modules),e=0;e<s.length;e++)!function(e){var e=s[e],t=$modules[e],n=$serviceConfig[e],r=Object.keys(n),o={};r.forEach(function(e){"default"!==e&&(o[e]=n[e].defaultResult())}),$store.registerModule(e,{namespaced:!0,state:function(){return __assign(__assign({},o),(t||{}).state||{})},mutations:__assign({receive:function(e,t){for(var n=Object.keys(e),r=0;r<n.length;r++){var o=n[r];e[o]=t[o]}}},(t||{}).mutations||{}),getters:__assign({},(t||{}).getters||{}),actions:__assign(__assign({},createActions({namespace:e,service:n,serviceKeys:r})),(t||{}).actions||{})})}(e)}function formatKey(e){return""+e.charAt(0).toUpperCase()+e.substring(1)}var plugin=function(e,t){return console.log("~~~~~~~~~~~~~~~~~~~~~~~~plugin的构造函数"),$serviceConfig=e,$modules=t,console.log("~~~~~~~~~~~~~~~~~~~~~~~~plugin的构造函数1",$serviceConfig),console.log("~~~~~~~~~~~~~~~~~~~~~~~~plugin的构造函数2",$modules),function(e){$store=e,registerLoading(),registerBusinessModules()}};exports.mapState=function(o){console.log("mapState",o);for(var s={loading:function(e){return e.loading}},e=function(e){for(var n=o[e],e=$serviceConfig[n],r=Object.keys(e),t=0;t<r.length;t++)!function(e){var t=r[e];if("default"===t)return;s[""+n+formatKey(t)]=function(e){return e[n][t]}}(t)},t=0;t<o.length;t++)e(t);return vuex_1.mapState(s)},exports.mapActions=function(e){for(var t={},n=0;n<e.length;n++)for(var r=e[n],o=$serviceConfig[r],s=Object.keys(o),i=0;i<s.length;i++){var a=s[i];"default"!==a&&(t[""+r+formatKey(a)+"Action"]=r+"/"+a)}return vuex_1.mapActions(t)},exports.mapMutations=function(e){for(var t={},n=0;n<e.length;n++){var r=e[n];t[r+"ReceiveMutation"]=r+"/receive"}return vuex_1.mapMutations(t)},exports.cleanMixin=function(e){return{beforeDestroy:function(){var o=this;e.forEach(function(e){var t=$serviceConfig[e],n=Object.keys(t),r={};n.forEach(function(e){"default"!==e&&(r[e]=t[e].defaultResult())}),o.$store.commit(e+"/receive",r)})}}},exports.default=plugin;
//# sourceMappingURL=vuexgenerator.js.map
